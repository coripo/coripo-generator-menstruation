{"version":3,"sources":["../src/menstruation.generator.js"],"names":["i18next","require","locales","Generator","dependencies","config","init","lng","locale","fallbackLng","initImmediate","resources","trl","key","store","data","changeLanguage","t","id","name","description","inputs","title","fields","label","type","helper","getAdapter","primaryAdapterId","generate","cfg","event","Event","generatorId","color","since","OneDate","start","till","offsetDay","periodLength","overlap","internal","external","repeats","times","cycle","step","cycleLength","sequels","scale","offset","exports"],"mappings":"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","file":"menstruation.generator.js","sourcesContent":["const i18next = require('i18next');\nconst locales = require('../locales/index.js');\n\nconst Generator = function Generator(dependencies, config = {}) {\n  i18next.init({\n    lng: config.locale || 'en',\n    fallbackLng: 'en',\n    initImmediate: false,\n    resources: locales,\n  });\n  const trl = (key) => {\n    i18next.store.data = locales;\n    i18next.changeLanguage(config.locale || 'en');\n    return i18next.t(key);\n  };\n  const id = 'coripo.coripo.generator.menstruation';\n  const name = trl('menstruation-generator.name');\n  const description = trl('menstruation-generator.description');\n  const inputs = [\n    {\n      title: trl('menstruation-generator.field-group.basic.title'),\n      fields: [\n        {\n          id: 'start',\n          label: trl('menstruation-generator.field-group.basic.field.start.label'),\n          type: 'date',\n        },\n        {\n          id: 'periodLength',\n          label: trl('menstruation-generator.field-group.basic.field.period-length.label'),\n          type: 'number',\n        },\n        {\n          id: 'cycleLength',\n          label: trl('menstruation-generator.field-group.basic.field.cycle-length.label'),\n          type: 'number',\n        },\n      ],\n    },\n  ];\n  const helper = {\n    getAdapter: dependencies.getAdapter,\n    primaryAdapterId: dependencies.primaryAdapterId,\n  };\n\n  const generate = (cfg) => {\n    const event = new dependencies.Event({\n      id: cfg.id,\n      generatorId: id,\n      title: trl('menstruation-generator.event.period-days.title'),\n      color: '#ee10f6',\n      since: new dependencies.OneDate(cfg.start, helper),\n      till: new dependencies.OneDate(cfg.start, helper).offsetDay(cfg.periodLength - 1),\n      overlap: { internal: 'trim', external: 'trim-forever' },\n      repeats: [{ times: -1, cycle: 'day', step: cfg.cycleLength }],\n      sequels: [\n        {\n          title: trl('menstruation-generator.event.peak-ovulation.title'),\n          color: '#00aeef',\n          since: { scale: 'day', offset: 10 },\n          till: { scale: 'day', offset: 14 },\n        },\n        {\n          title: trl('menstruation-generator.event.pre-period.title'),\n          color: '#f36',\n          since: { scale: 'day', offset: -2 },\n          till: { scale: 'day', offset: -1 },\n        },\n        {\n          title: trl('menstruation-generator.event.post-period.title'),\n          color: '#7e70ff',\n          since: { scale: 'day', offset: cfg.periodLength },\n          till: { scale: 'day', offset: cfg.periodLength + 1 },\n        },\n      ],\n    });\n    return event;\n  };\n\n  return { id, name, description, inputs, generate };\n};\n\nexports.Generator = Generator;\n"]}