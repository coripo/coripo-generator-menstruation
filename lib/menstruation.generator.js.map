{"version":3,"sources":["../src/menstruation.generator.js"],"names":["i18next","require","locales","Generator","dependencies","config","init","lng","locale","fallbackLng","initImmediate","resources","trl","key","store","data","changeLanguage","t","id","name","description","inputs","title","fields","label","type","helper","getAdapter","primaryAdapterId","generate","cfg","event","Event","dna","generatorId","color","since","OneDate","start","till","offsetDay","periodLength","overlap","internal","external","repeats","times","cycle","step","cycleLength","sequels","scale","offset","module","exports"],"mappings":"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","file":"menstruation.generator.js","sourcesContent":["const i18next = require('i18next');\nconst locales = require('../locales/index.js');\n\nconst Generator = function Generator(dependencies, config = {}) {\n  i18next.init({\n    lng: config.locale || 'en',\n    fallbackLng: 'en',\n    initImmediate: false,\n    resources: locales,\n  });\n  const trl = (key) => {\n    i18next.store.data = locales;\n    i18next.changeLanguage(config.locale || 'en');\n    return i18next.t(key);\n  };\n  const id = 'coripo.coripo.generator.menstruation';\n  const name = trl('menstruation-generator.name');\n  const description = trl('menstruation-generator.description');\n  const inputs = [\n    {\n      title: trl('menstruation-generator.field-group.basic.title'),\n      fields: [\n        {\n          id: 'start',\n          label: trl('menstruation-generator.field-group.basic.field.start.label'),\n          type: 'date',\n        },\n        {\n          id: 'periodLength',\n          label: trl('menstruation-generator.field-group.basic.field.period-length.label'),\n          type: 'number',\n        },\n        {\n          id: 'cycleLength',\n          label: trl('menstruation-generator.field-group.basic.field.cycle-length.label'),\n          type: 'number',\n        },\n      ],\n    },\n  ];\n  const helper = {\n    getAdapter: dependencies.getAdapter,\n    primaryAdapterId: dependencies.primaryAdapterId,\n  };\n\n  const generate = (cfg) => {\n    const event = new dependencies.Event({\n      dna: cfg,\n      id: cfg.id,\n      generatorId: id,\n      title: trl('menstruation-generator.event.period-days.title'),\n      color: '#ee10f6',\n      since: new dependencies.OneDate(cfg.start, helper),\n      till: new dependencies.OneDate(cfg.start, helper).offsetDay(cfg.periodLength - 1),\n      overlap: { internal: 'trim', external: 'trim-forever' },\n      repeats: [{ times: -1, cycle: 'day', step: cfg.cycleLength }],\n      sequels: [\n        {\n          title: trl('menstruation-generator.event.peak-ovulation.title'),\n          color: '#00aeef',\n          since: { scale: 'day', offset: 10 },\n          till: { scale: 'day', offset: 14 },\n        },\n        {\n          title: trl('menstruation-generator.event.pre-period.title'),\n          color: '#f36',\n          since: { scale: 'day', offset: -2 },\n          till: { scale: 'day', offset: -1 },\n        },\n        {\n          title: trl('menstruation-generator.event.post-period.title'),\n          color: '#7e70ff',\n          since: { scale: 'day', offset: cfg.periodLength },\n          till: { scale: 'day', offset: cfg.periodLength + 1 },\n        },\n      ],\n    });\n    return event;\n  };\n\n  return { id, name, description, inputs, generate };\n};\n\nmodule.exports = Generator;\n"]}